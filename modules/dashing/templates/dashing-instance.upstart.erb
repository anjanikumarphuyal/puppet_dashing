# Ubuntu upstart file at /etc/init/dashing-instance.conf
#
# Generated by puppet: DO NOT EDIT!
#
# Author: Ricardo Rocha <ricardo@catalyst.net.nz>
#
 
limit nofile 20000 20000
 
kill timeout 10 # wait 10s between SIGTERM and SIGKILL.
 
stop on runlevel [06]
 
instance $CONFIG
 
script
    if [ -f "$CONFIG" ]
    then
        name="`basename $CONFIG .conf`"
        pidfile="/var/run/dashing/${name}.pid"
        . $CONFIG
        cd $DASHING_DIR
        start-stop-daemon --pidfile "$pidfile" --start --quiet --chuid $DASHING_RUNUSER --chdir $DASHING_DIR --exec <%= scope.lookupvar('dashing::dashing_binary') %> start -- -p $DASHING_PORT
    fi
end script
 
post-stop script
    if [ -f "$CONFIG" ]
    then
        pidfile="/var/run/dashing/`basename $CONFIG .conf`.pid"
        rm -f "$pidfile"
    fi
end script
